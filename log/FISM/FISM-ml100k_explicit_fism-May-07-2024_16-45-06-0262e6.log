Tue 07 May 2024 16:45:06 INFO  ['/home/stef/.local/lib/python3.10/site-packages/ipykernel_launcher.py', '-f', '/home/stef/.local/share/jupyter/runtime/kernel-efa788d2-160d-4c4b-a772-cea6c099cb9e.json']
Tue 07 May 2024 16:45:06 INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = dataset/ml100k_explicit_fism
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 100
train_batch_size = 2048
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'uniform', 'sample_num': 1, 'alpha': 1.0, 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'RO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = False
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 4096
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = rating
TIME_FIELD = timestamp
seq_len = None
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = None
embedding_size = 64
split_to = 0
reg_weights = [0.01, 0.01]
alpha = 0.0
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.GENERAL
eval_setting = RO_RS
early_stop = 5
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
device = cpu
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


Tue 07 May 2024 16:45:06 INFO  ml100k_explicit_fism
The number of users: 944
Average actions of users: 106.04453870625663
The number of items: 1683
Average actions of items: 59.45303210463734
The number of inters: 100000
The sparsity of the dataset: 93.70575143257098%
Remain Fields: ['user_id', 'item_id']
Tue 07 May 2024 16:45:07 INFO  [Training]: train_batch_size = [2048] train_neg_sample_args: [{'distribution': 'uniform', 'sample_num': 1, 'alpha': 1.0, 'dynamic': False, 'candidate_num': 0}]
Tue 07 May 2024 16:45:07 INFO  [Evaluation]: eval_batch_size = [4096] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'RO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
Tue 07 May 2024 16:45:07 WARNING  Max value of user's history interaction records has reached 35.115864527629235% of the total.
Tue 07 May 2024 16:45:07 WARNING  Pay Attetion!! the `split_to` is set to 0. If you catch a OMM error in this case, you need to increase it 
			until the error disappears. For example, you can append it in the command line such as `--split_to=5`
Tue 07 May 2024 16:45:07 INFO  FISM(
  (item_src_embedding): Embedding(1683, 64, padding_idx=0)
  (item_dst_embedding): Embedding(1683, 64, padding_idx=0)
  (bceloss): BCEWithLogitsLoss()
)
Trainable parameters: 218051
Tue 07 May 2024 16:45:07 INFO  FLOPs: 37888.0
Tue 07 May 2024 16:45:49 INFO  epoch 0 training [time: 41.18s, train loss: 57.8046]
Tue 07 May 2024 16:46:12 INFO  epoch 0 evaluating [time: 23.22s, valid_score: 0.213100]
Tue 07 May 2024 16:46:12 INFO  valid result: 
recall@10 : 0.0988    mrr@10 : 0.2131    ndcg@10 : 0.1111    hit@10 : 0.5016    precision@10 : 0.0844
Tue 07 May 2024 16:46:12 INFO  Saving current: saved/FISM-May-07-2024_16-45-07.pth
Tue 07 May 2024 16:46:59 INFO  epoch 1 training [time: 47.19s, train loss: 56.6618]
Tue 07 May 2024 16:47:20 INFO  epoch 1 evaluating [time: 20.12s, valid_score: 0.213500]
Tue 07 May 2024 16:47:20 INFO  valid result: 
recall@10 : 0.1132    mrr@10 : 0.2135    ndcg@10 : 0.1194    hit@10 : 0.5429    precision@10 : 0.0897
Tue 07 May 2024 16:47:20 INFO  Saving current: saved/FISM-May-07-2024_16-45-07.pth
Tue 07 May 2024 16:47:57 INFO  epoch 2 training [time: 37.01s, train loss: 56.2961]
Tue 07 May 2024 16:48:17 INFO  epoch 2 evaluating [time: 20.61s, valid_score: 0.217200]
Tue 07 May 2024 16:48:17 INFO  valid result: 
recall@10 : 0.1159    mrr@10 : 0.2172    ndcg@10 : 0.1197    hit@10 : 0.5472    precision@10 : 0.0902
Tue 07 May 2024 16:48:17 INFO  Saving current: saved/FISM-May-07-2024_16-45-07.pth
Tue 07 May 2024 16:48:56 INFO  epoch 3 training [time: 38.46s, train loss: 55.9455]
Tue 07 May 2024 16:49:22 INFO  epoch 3 evaluating [time: 26.20s, valid_score: 0.222300]
Tue 07 May 2024 16:49:22 INFO  valid result: 
recall@10 : 0.1161    mrr@10 : 0.2223    ndcg@10 : 0.121    hit@10 : 0.5472    precision@10 : 0.0899
Tue 07 May 2024 16:49:22 INFO  Saving current: saved/FISM-May-07-2024_16-45-07.pth
Tue 07 May 2024 16:50:02 INFO  epoch 4 training [time: 40.27s, train loss: 55.6220]
Tue 07 May 2024 16:50:25 INFO  epoch 4 evaluating [time: 22.43s, valid_score: 0.228300]
Tue 07 May 2024 16:50:25 INFO  valid result: 
recall@10 : 0.1152    mrr@10 : 0.2283    ndcg@10 : 0.1213    hit@10 : 0.5493    precision@10 : 0.0903
Tue 07 May 2024 16:50:25 INFO  Saving current: saved/FISM-May-07-2024_16-45-07.pth
Tue 07 May 2024 16:51:06 INFO  epoch 5 training [time: 41.25s, train loss: 55.3138]
Tue 07 May 2024 16:51:30 INFO  epoch 5 evaluating [time: 24.23s, valid_score: 0.227300]
Tue 07 May 2024 16:51:30 INFO  valid result: 
recall@10 : 0.1145    mrr@10 : 0.2273    ndcg@10 : 0.1214    hit@10 : 0.5461    precision@10 : 0.0908
Tue 07 May 2024 16:52:15 INFO  epoch 6 training [time: 45.34s, train loss: 55.0210]
Tue 07 May 2024 16:52:39 INFO  epoch 6 evaluating [time: 23.19s, valid_score: 0.223100]
Tue 07 May 2024 16:52:39 INFO  valid result: 
recall@10 : 0.1116    mrr@10 : 0.2231    ndcg@10 : 0.1191    hit@10 : 0.5376    precision@10 : 0.09
Tue 07 May 2024 16:53:20 INFO  epoch 7 training [time: 41.60s, train loss: 54.7595]
Tue 07 May 2024 16:53:43 INFO  epoch 7 evaluating [time: 23.05s, valid_score: 0.226500]
Tue 07 May 2024 16:53:43 INFO  valid result: 
recall@10 : 0.1103    mrr@10 : 0.2265    ndcg@10 : 0.1185    hit@10 : 0.5355    precision@10 : 0.0898
Tue 07 May 2024 16:54:24 INFO  epoch 8 training [time: 40.85s, train loss: 54.5134]
Tue 07 May 2024 16:54:47 INFO  epoch 8 evaluating [time: 22.95s, valid_score: 0.226600]
Tue 07 May 2024 16:54:47 INFO  valid result: 
recall@10 : 0.1111    mrr@10 : 0.2266    ndcg@10 : 0.119    hit@10 : 0.5323    precision@10 : 0.0897
Tue 07 May 2024 16:55:28 INFO  epoch 9 training [time: 41.19s, train loss: 54.2627]
Tue 07 May 2024 16:55:51 INFO  epoch 9 evaluating [time: 22.70s, valid_score: 0.225800]
Tue 07 May 2024 16:55:51 INFO  valid result: 
recall@10 : 0.1096    mrr@10 : 0.2258    ndcg@10 : 0.1186    hit@10 : 0.5355    precision@10 : 0.0897
Tue 07 May 2024 16:56:33 INFO  epoch 10 training [time: 41.65s, train loss: 54.0475]
Tue 07 May 2024 16:56:56 INFO  epoch 10 evaluating [time: 23.26s, valid_score: 0.225600]
Tue 07 May 2024 16:56:56 INFO  valid result: 
recall@10 : 0.1108    mrr@10 : 0.2256    ndcg@10 : 0.1192    hit@10 : 0.5334    precision@10 : 0.0901
Tue 07 May 2024 16:57:37 INFO  epoch 11 training [time: 41.57s, train loss: 53.8364]
Tue 07 May 2024 16:58:01 INFO  epoch 11 evaluating [time: 23.29s, valid_score: 0.226600]
Tue 07 May 2024 16:58:01 INFO  valid result: 
recall@10 : 0.1095    mrr@10 : 0.2266    ndcg@10 : 0.1192    hit@10 : 0.5313    precision@10 : 0.0901
Tue 07 May 2024 16:58:40 INFO  epoch 12 training [time: 39.49s, train loss: 53.6433]
Tue 07 May 2024 16:59:01 INFO  epoch 12 evaluating [time: 20.97s, valid_score: 0.226400]
Tue 07 May 2024 16:59:01 INFO  valid result: 
recall@10 : 0.1112    mrr@10 : 0.2264    ndcg@10 : 0.1191    hit@10 : 0.5334    precision@10 : 0.0907
Tue 07 May 2024 16:59:40 INFO  epoch 13 training [time: 38.70s, train loss: 53.4755]
Tue 07 May 2024 17:00:01 INFO  epoch 13 evaluating [time: 20.86s, valid_score: 0.229600]
Tue 07 May 2024 17:00:01 INFO  valid result: 
recall@10 : 0.1115    mrr@10 : 0.2296    ndcg@10 : 0.1205    hit@10 : 0.5376    precision@10 : 0.0909
Tue 07 May 2024 17:00:01 INFO  Saving current: saved/FISM-May-07-2024_16-45-07.pth
Tue 07 May 2024 17:00:38 INFO  epoch 14 training [time: 37.14s, train loss: 53.3050]
Tue 07 May 2024 17:00:59 INFO  epoch 14 evaluating [time: 20.76s, valid_score: 0.228700]
Tue 07 May 2024 17:00:59 INFO  valid result: 
recall@10 : 0.1104    mrr@10 : 0.2287    ndcg@10 : 0.1201    hit@10 : 0.5366    precision@10 : 0.0905
Tue 07 May 2024 17:01:36 INFO  epoch 15 training [time: 36.97s, train loss: 53.1248]
Tue 07 May 2024 17:01:56 INFO  epoch 15 evaluating [time: 20.79s, valid_score: 0.228100]
Tue 07 May 2024 17:01:56 INFO  valid result: 
recall@10 : 0.1118    mrr@10 : 0.2281    ndcg@10 : 0.1208    hit@10 : 0.5387    precision@10 : 0.0909
Tue 07 May 2024 17:02:34 INFO  epoch 16 training [time: 37.29s, train loss: 52.9736]
Tue 07 May 2024 17:02:56 INFO  epoch 16 evaluating [time: 21.93s, valid_score: 0.229200]
Tue 07 May 2024 17:02:56 INFO  valid result: 
recall@10 : 0.1114    mrr@10 : 0.2292    ndcg@10 : 0.121    hit@10 : 0.5366    precision@10 : 0.0911
Tue 07 May 2024 17:03:31 INFO  epoch 17 training [time: 35.31s, train loss: 52.8382]
Tue 07 May 2024 17:03:51 INFO  epoch 17 evaluating [time: 20.33s, valid_score: 0.229700]
Tue 07 May 2024 17:03:51 INFO  valid result: 
recall@10 : 0.111    mrr@10 : 0.2297    ndcg@10 : 0.1213    hit@10 : 0.5366    precision@10 : 0.0913
Tue 07 May 2024 17:03:51 INFO  Saving current: saved/FISM-May-07-2024_16-45-07.pth
Tue 07 May 2024 17:04:27 INFO  epoch 18 training [time: 36.01s, train loss: 52.6935]
Tue 07 May 2024 17:04:47 INFO  epoch 18 evaluating [time: 20.17s, valid_score: 0.228800]
Tue 07 May 2024 17:04:48 INFO  valid result: 
recall@10 : 0.1112    mrr@10 : 0.2288    ndcg@10 : 0.1207    hit@10 : 0.5355    precision@10 : 0.0911
Tue 07 May 2024 17:05:23 INFO  epoch 19 training [time: 35.74s, train loss: 52.5719]
Tue 07 May 2024 17:05:43 INFO  epoch 19 evaluating [time: 20.17s, valid_score: 0.230500]
Tue 07 May 2024 17:05:43 INFO  valid result: 
recall@10 : 0.1105    mrr@10 : 0.2305    ndcg@10 : 0.1208    hit@10 : 0.5355    precision@10 : 0.0912
Tue 07 May 2024 17:05:43 INFO  Saving current: saved/FISM-May-07-2024_16-45-07.pth
Tue 07 May 2024 17:06:19 INFO  epoch 20 training [time: 35.75s, train loss: 52.4492]
Tue 07 May 2024 17:06:39 INFO  epoch 20 evaluating [time: 20.18s, valid_score: 0.230100]
Tue 07 May 2024 17:06:39 INFO  valid result: 
recall@10 : 0.1106    mrr@10 : 0.2301    ndcg@10 : 0.1206    hit@10 : 0.5345    precision@10 : 0.0912
Tue 07 May 2024 17:07:15 INFO  epoch 21 training [time: 35.58s, train loss: 52.3311]
Tue 07 May 2024 17:07:35 INFO  epoch 21 evaluating [time: 20.28s, valid_score: 0.230100]
Tue 07 May 2024 17:07:35 INFO  valid result: 
recall@10 : 0.1115    mrr@10 : 0.2301    ndcg@10 : 0.1216    hit@10 : 0.5376    precision@10 : 0.0926
Tue 07 May 2024 17:08:11 INFO  epoch 22 training [time: 35.79s, train loss: 52.2200]
Tue 07 May 2024 17:08:31 INFO  epoch 22 evaluating [time: 19.87s, valid_score: 0.229700]
Tue 07 May 2024 17:08:31 INFO  valid result: 
recall@10 : 0.1107    mrr@10 : 0.2297    ndcg@10 : 0.1208    hit@10 : 0.5345    precision@10 : 0.0913
Tue 07 May 2024 17:09:07 INFO  epoch 23 training [time: 35.69s, train loss: 52.1054]
Tue 07 May 2024 17:09:27 INFO  epoch 23 evaluating [time: 20.08s, valid_score: 0.229500]
Tue 07 May 2024 17:09:27 INFO  valid result: 
recall@10 : 0.1102    mrr@10 : 0.2295    ndcg@10 : 0.1209    hit@10 : 0.5345    precision@10 : 0.0916
Tue 07 May 2024 17:10:03 INFO  epoch 24 training [time: 35.96s, train loss: 51.9833]
Tue 07 May 2024 17:10:23 INFO  epoch 24 evaluating [time: 20.15s, valid_score: 0.228900]
Tue 07 May 2024 17:10:23 INFO  valid result: 
recall@10 : 0.1099    mrr@10 : 0.2289    ndcg@10 : 0.1207    hit@10 : 0.5323    precision@10 : 0.0913
Tue 07 May 2024 17:10:58 INFO  epoch 25 training [time: 35.49s, train loss: 51.9129]
Tue 07 May 2024 17:11:18 INFO  epoch 25 evaluating [time: 20.05s, valid_score: 0.228600]
Tue 07 May 2024 17:11:18 INFO  valid result: 
recall@10 : 0.1095    mrr@10 : 0.2286    ndcg@10 : 0.1205    hit@10 : 0.5302    precision@10 : 0.0912
Tue 07 May 2024 17:11:54 INFO  epoch 26 training [time: 35.48s, train loss: 51.7877]
Tue 07 May 2024 17:12:14 INFO  epoch 26 evaluating [time: 20.04s, valid_score: 0.228700]
Tue 07 May 2024 17:12:14 INFO  valid result: 
recall@10 : 0.1099    mrr@10 : 0.2287    ndcg@10 : 0.1209    hit@10 : 0.5313    precision@10 : 0.0918
Tue 07 May 2024 17:12:50 INFO  epoch 27 training [time: 35.68s, train loss: 51.7274]
Tue 07 May 2024 17:13:09 INFO  epoch 27 evaluating [time: 19.93s, valid_score: 0.228300]
Tue 07 May 2024 17:13:09 INFO  valid result: 
recall@10 : 0.1092    mrr@10 : 0.2283    ndcg@10 : 0.1205    hit@10 : 0.5302    precision@10 : 0.091
Tue 07 May 2024 17:13:45 INFO  epoch 28 training [time: 35.47s, train loss: 51.6105]
Tue 07 May 2024 17:14:05 INFO  epoch 28 evaluating [time: 19.96s, valid_score: 0.228700]
Tue 07 May 2024 17:14:05 INFO  valid result: 
recall@10 : 0.1091    mrr@10 : 0.2287    ndcg@10 : 0.1206    hit@10 : 0.5302    precision@10 : 0.0911
Tue 07 May 2024 17:14:41 INFO  epoch 29 training [time: 35.79s, train loss: 51.5139]
Tue 07 May 2024 17:15:01 INFO  epoch 29 evaluating [time: 19.95s, valid_score: 0.228700]
Tue 07 May 2024 17:15:01 INFO  valid result: 
recall@10 : 0.1092    mrr@10 : 0.2287    ndcg@10 : 0.1206    hit@10 : 0.5313    precision@10 : 0.0911
Tue 07 May 2024 17:15:38 INFO  epoch 30 training [time: 37.01s, train loss: 51.4333]
Tue 07 May 2024 17:15:58 INFO  epoch 30 evaluating [time: 20.73s, valid_score: 0.228600]
Tue 07 May 2024 17:15:58 INFO  valid result: 
recall@10 : 0.1095    mrr@10 : 0.2286    ndcg@10 : 0.1207    hit@10 : 0.5313    precision@10 : 0.0912
Tue 07 May 2024 17:15:58 INFO  Finished training, best eval result in epoch 19
Tue 07 May 2024 17:15:58 INFO  Loading model structure and parameters from saved/FISM-May-07-2024_16-45-07.pth
Tue 07 May 2024 17:16:22 INFO  The running environment of this training is as follows:
+-------------+----------------+
| Environment |     Usage      |
+=============+================+
| CPU         |     9.80 %     |
+-------------+----------------+
| GPU         |   0.0 / 0.0    |
+-------------+----------------+
| Memory      | 0.67 G/13.86 G |
+-------------+----------------+
Tue 07 May 2024 17:16:22 INFO  best valid : OrderedDict([('recall@10', 0.1105), ('mrr@10', 0.2305), ('ndcg@10', 0.1208), ('hit@10', 0.5355), ('precision@10', 0.0912)])
Tue 07 May 2024 17:16:22 INFO  test result: OrderedDict([('recall@10', 0.122), ('mrr@10', 0.2669), ('ndcg@10', 0.1409), ('hit@10', 0.562), ('precision@10', 0.1055)])
Tue 07 May 2024 17:27:51 INFO  ['/home/stef/.local/lib/python3.10/site-packages/ipykernel_launcher.py', '-f', '/home/stef/.local/share/jupyter/runtime/kernel-efa788d2-160d-4c4b-a772-cea6c099cb9e.json']
Tue 07 May 2024 17:27:51 INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = dataset/ml100k_implicit_fism
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 100
train_batch_size = 2048
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'uniform', 'sample_num': 1, 'alpha': 1.0, 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'RO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = False
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 4096
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = rating
TIME_FIELD = timestamp
seq_len = None
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = None
embedding_size = 64
split_to = 0
reg_weights = [0.01, 0.01]
alpha = 0.0
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.GENERAL
eval_setting = RO_RS
early_stop = 5
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
device = cpu
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


Tue 07 May 2024 17:27:52 INFO  ml100k_implicit_fism
The number of users: 944
Average actions of users: 106.04453870625663
The number of items: 1683
Average actions of items: 59.45303210463734
The number of inters: 100000
The sparsity of the dataset: 93.70575143257098%
Remain Fields: ['user_id', 'item_id']
Tue 07 May 2024 17:27:52 INFO  [Training]: train_batch_size = [2048] train_neg_sample_args: [{'distribution': 'uniform', 'sample_num': 1, 'alpha': 1.0, 'dynamic': False, 'candidate_num': 0}]
Tue 07 May 2024 17:27:52 INFO  [Evaluation]: eval_batch_size = [4096] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'RO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
Tue 07 May 2024 17:27:52 WARNING  Max value of user's history interaction records has reached 35.115864527629235% of the total.
Tue 07 May 2024 17:27:52 WARNING  Pay Attetion!! the `split_to` is set to 0. If you catch a OMM error in this case, you need to increase it 
			until the error disappears. For example, you can append it in the command line such as `--split_to=5`
Tue 07 May 2024 17:27:52 INFO  FISM(
  (item_src_embedding): Embedding(1683, 64, padding_idx=0)
  (item_dst_embedding): Embedding(1683, 64, padding_idx=0)
  (bceloss): BCEWithLogitsLoss()
)
Trainable parameters: 218051
Tue 07 May 2024 17:27:52 INFO  FLOPs: 37888.0
Tue 07 May 2024 17:28:28 INFO  epoch 0 training [time: 36.37s, train loss: 57.8046]
Tue 07 May 2024 17:28:53 INFO  epoch 0 evaluating [time: 25.04s, valid_score: 0.213100]
Tue 07 May 2024 17:28:53 INFO  valid result: 
recall@10 : 0.0988    mrr@10 : 0.2131    ndcg@10 : 0.1111    hit@10 : 0.5016    precision@10 : 0.0844
Tue 07 May 2024 17:28:53 INFO  Saving current: saved/FISM-May-07-2024_17-27-52.pth
Tue 07 May 2024 17:29:37 INFO  epoch 1 training [time: 44.13s, train loss: 56.6618]
Tue 07 May 2024 17:30:01 INFO  epoch 1 evaluating [time: 23.77s, valid_score: 0.213500]
Tue 07 May 2024 17:30:01 INFO  valid result: 
recall@10 : 0.1132    mrr@10 : 0.2135    ndcg@10 : 0.1194    hit@10 : 0.5429    precision@10 : 0.0897
Tue 07 May 2024 17:30:01 INFO  Saving current: saved/FISM-May-07-2024_17-27-52.pth
Tue 07 May 2024 17:30:36 INFO  epoch 2 training [time: 34.37s, train loss: 56.2961]
Tue 07 May 2024 17:30:55 INFO  epoch 2 evaluating [time: 19.54s, valid_score: 0.217200]
Tue 07 May 2024 17:30:55 INFO  valid result: 
recall@10 : 0.1159    mrr@10 : 0.2172    ndcg@10 : 0.1197    hit@10 : 0.5472    precision@10 : 0.0902
Tue 07 May 2024 17:30:55 INFO  Saving current: saved/FISM-May-07-2024_17-27-52.pth
Tue 07 May 2024 17:31:38 INFO  epoch 3 training [time: 42.96s, train loss: 55.9455]
Tue 07 May 2024 17:32:03 INFO  epoch 3 evaluating [time: 24.68s, valid_score: 0.222300]
Tue 07 May 2024 17:32:03 INFO  valid result: 
recall@10 : 0.1161    mrr@10 : 0.2223    ndcg@10 : 0.121    hit@10 : 0.5472    precision@10 : 0.0899
Tue 07 May 2024 17:32:03 INFO  Saving current: saved/FISM-May-07-2024_17-27-52.pth
Tue 07 May 2024 17:32:47 INFO  epoch 4 training [time: 44.10s, train loss: 55.6220]
Tue 07 May 2024 17:33:12 INFO  epoch 4 evaluating [time: 24.67s, valid_score: 0.228300]
Tue 07 May 2024 17:33:12 INFO  valid result: 
recall@10 : 0.1152    mrr@10 : 0.2283    ndcg@10 : 0.1213    hit@10 : 0.5493    precision@10 : 0.0903
Tue 07 May 2024 17:33:12 INFO  Saving current: saved/FISM-May-07-2024_17-27-52.pth
Tue 07 May 2024 17:33:56 INFO  epoch 5 training [time: 44.02s, train loss: 55.3138]
Tue 07 May 2024 17:34:21 INFO  epoch 5 evaluating [time: 24.95s, valid_score: 0.227300]
Tue 07 May 2024 17:34:21 INFO  valid result: 
recall@10 : 0.1145    mrr@10 : 0.2273    ndcg@10 : 0.1214    hit@10 : 0.5461    precision@10 : 0.0908
Tue 07 May 2024 17:35:05 INFO  epoch 6 training [time: 44.02s, train loss: 55.0210]
Tue 07 May 2024 17:35:30 INFO  epoch 6 evaluating [time: 25.59s, valid_score: 0.223100]
Tue 07 May 2024 17:35:30 INFO  valid result: 
recall@10 : 0.1116    mrr@10 : 0.2231    ndcg@10 : 0.1191    hit@10 : 0.5376    precision@10 : 0.09
Tue 07 May 2024 17:36:14 INFO  epoch 7 training [time: 43.76s, train loss: 54.7595]
Tue 07 May 2024 17:36:38 INFO  epoch 7 evaluating [time: 23.86s, valid_score: 0.226500]
Tue 07 May 2024 17:36:38 INFO  valid result: 
recall@10 : 0.1103    mrr@10 : 0.2265    ndcg@10 : 0.1185    hit@10 : 0.5355    precision@10 : 0.0898
Tue 07 May 2024 17:37:21 INFO  epoch 8 training [time: 43.60s, train loss: 54.5134]
Tue 07 May 2024 17:37:46 INFO  epoch 8 evaluating [time: 24.62s, valid_score: 0.226600]
Tue 07 May 2024 17:37:46 INFO  valid result: 
recall@10 : 0.1111    mrr@10 : 0.2266    ndcg@10 : 0.119    hit@10 : 0.5323    precision@10 : 0.0897
Tue 07 May 2024 17:38:30 INFO  epoch 9 training [time: 43.75s, train loss: 54.2627]
Tue 07 May 2024 17:38:54 INFO  epoch 9 evaluating [time: 23.83s, valid_score: 0.225800]
Tue 07 May 2024 17:38:54 INFO  valid result: 
recall@10 : 0.1096    mrr@10 : 0.2258    ndcg@10 : 0.1186    hit@10 : 0.5355    precision@10 : 0.0897
Tue 07 May 2024 17:39:36 INFO  epoch 10 training [time: 42.36s, train loss: 54.0475]
Tue 07 May 2024 17:40:01 INFO  epoch 10 evaluating [time: 24.75s, valid_score: 0.225600]
Tue 07 May 2024 17:40:01 INFO  valid result: 
recall@10 : 0.1108    mrr@10 : 0.2256    ndcg@10 : 0.1192    hit@10 : 0.5334    precision@10 : 0.0901
Tue 07 May 2024 17:40:44 INFO  epoch 11 training [time: 43.20s, train loss: 53.8364]
Tue 07 May 2024 17:41:09 INFO  epoch 11 evaluating [time: 24.57s, valid_score: 0.226600]
Tue 07 May 2024 17:41:09 INFO  valid result: 
recall@10 : 0.1095    mrr@10 : 0.2266    ndcg@10 : 0.1192    hit@10 : 0.5313    precision@10 : 0.0901
Tue 07 May 2024 17:41:53 INFO  epoch 12 training [time: 44.73s, train loss: 53.6433]
Tue 07 May 2024 17:42:17 INFO  epoch 12 evaluating [time: 24.13s, valid_score: 0.226400]
Tue 07 May 2024 17:42:17 INFO  valid result: 
recall@10 : 0.1112    mrr@10 : 0.2264    ndcg@10 : 0.1191    hit@10 : 0.5334    precision@10 : 0.0907
Tue 07 May 2024 17:43:01 INFO  epoch 13 training [time: 43.74s, train loss: 53.4755]
Tue 07 May 2024 17:43:26 INFO  epoch 13 evaluating [time: 24.49s, valid_score: 0.229600]
Tue 07 May 2024 17:43:26 INFO  valid result: 
recall@10 : 0.1115    mrr@10 : 0.2296    ndcg@10 : 0.1205    hit@10 : 0.5376    precision@10 : 0.0909
Tue 07 May 2024 17:43:26 INFO  Saving current: saved/FISM-May-07-2024_17-27-52.pth
Tue 07 May 2024 17:44:10 INFO  epoch 14 training [time: 44.45s, train loss: 53.3050]
Tue 07 May 2024 17:44:35 INFO  epoch 14 evaluating [time: 24.55s, valid_score: 0.228700]
Tue 07 May 2024 17:44:35 INFO  valid result: 
recall@10 : 0.1104    mrr@10 : 0.2287    ndcg@10 : 0.1201    hit@10 : 0.5366    precision@10 : 0.0905
Tue 07 May 2024 17:45:19 INFO  epoch 15 training [time: 44.11s, train loss: 53.1248]
Tue 07 May 2024 17:45:43 INFO  epoch 15 evaluating [time: 24.62s, valid_score: 0.228100]
Tue 07 May 2024 17:45:43 INFO  valid result: 
recall@10 : 0.1118    mrr@10 : 0.2281    ndcg@10 : 0.1208    hit@10 : 0.5387    precision@10 : 0.0909
Tue 07 May 2024 17:46:24 INFO  epoch 16 training [time: 40.79s, train loss: 52.9736]
Tue 07 May 2024 17:46:44 INFO  epoch 16 evaluating [time: 20.15s, valid_score: 0.229200]
Tue 07 May 2024 17:46:44 INFO  valid result: 
recall@10 : 0.1114    mrr@10 : 0.2292    ndcg@10 : 0.121    hit@10 : 0.5366    precision@10 : 0.0911
Tue 07 May 2024 17:47:24 INFO  epoch 17 training [time: 40.10s, train loss: 52.8382]
Tue 07 May 2024 17:47:46 INFO  epoch 17 evaluating [time: 21.65s, valid_score: 0.229700]
Tue 07 May 2024 17:47:46 INFO  valid result: 
recall@10 : 0.111    mrr@10 : 0.2297    ndcg@10 : 0.1213    hit@10 : 0.5366    precision@10 : 0.0913
Tue 07 May 2024 17:47:46 INFO  Saving current: saved/FISM-May-07-2024_17-27-52.pth
Tue 07 May 2024 17:48:26 INFO  epoch 18 training [time: 39.43s, train loss: 52.6935]
Tue 07 May 2024 17:48:47 INFO  epoch 18 evaluating [time: 21.91s, valid_score: 0.228800]
Tue 07 May 2024 17:48:47 INFO  valid result: 
recall@10 : 0.1112    mrr@10 : 0.2288    ndcg@10 : 0.1207    hit@10 : 0.5355    precision@10 : 0.0911
Tue 07 May 2024 17:49:26 INFO  epoch 19 training [time: 38.68s, train loss: 52.5719]
Tue 07 May 2024 17:49:48 INFO  epoch 19 evaluating [time: 21.82s, valid_score: 0.230500]
Tue 07 May 2024 17:49:48 INFO  valid result: 
recall@10 : 0.1105    mrr@10 : 0.2305    ndcg@10 : 0.1208    hit@10 : 0.5355    precision@10 : 0.0912
Tue 07 May 2024 17:49:48 INFO  Saving current: saved/FISM-May-07-2024_17-27-52.pth
Tue 07 May 2024 17:50:27 INFO  epoch 20 training [time: 39.16s, train loss: 52.4492]
Tue 07 May 2024 17:50:49 INFO  epoch 20 evaluating [time: 21.72s, valid_score: 0.230100]
Tue 07 May 2024 17:50:49 INFO  valid result: 
recall@10 : 0.1106    mrr@10 : 0.2301    ndcg@10 : 0.1206    hit@10 : 0.5345    precision@10 : 0.0912
Tue 07 May 2024 17:51:28 INFO  epoch 21 training [time: 38.76s, train loss: 52.3311]
Tue 07 May 2024 17:51:49 INFO  epoch 21 evaluating [time: 21.84s, valid_score: 0.230100]
Tue 07 May 2024 17:51:49 INFO  valid result: 
recall@10 : 0.1115    mrr@10 : 0.2301    ndcg@10 : 0.1216    hit@10 : 0.5376    precision@10 : 0.0926
Tue 07 May 2024 17:52:28 INFO  epoch 22 training [time: 38.94s, train loss: 52.2200]
Tue 07 May 2024 17:52:50 INFO  epoch 22 evaluating [time: 21.82s, valid_score: 0.229700]
Tue 07 May 2024 17:52:50 INFO  valid result: 
recall@10 : 0.1107    mrr@10 : 0.2297    ndcg@10 : 0.1208    hit@10 : 0.5345    precision@10 : 0.0913
Tue 07 May 2024 17:53:29 INFO  epoch 23 training [time: 38.91s, train loss: 52.1054]
Tue 07 May 2024 17:53:51 INFO  epoch 23 evaluating [time: 21.75s, valid_score: 0.229500]
Tue 07 May 2024 17:53:51 INFO  valid result: 
recall@10 : 0.1102    mrr@10 : 0.2295    ndcg@10 : 0.1209    hit@10 : 0.5345    precision@10 : 0.0916
Tue 07 May 2024 17:54:30 INFO  epoch 24 training [time: 39.12s, train loss: 51.9833]
Tue 07 May 2024 17:54:52 INFO  epoch 24 evaluating [time: 21.85s, valid_score: 0.228900]
Tue 07 May 2024 17:54:52 INFO  valid result: 
recall@10 : 0.1099    mrr@10 : 0.2289    ndcg@10 : 0.1207    hit@10 : 0.5323    precision@10 : 0.0913
Tue 07 May 2024 17:55:26 INFO  epoch 25 training [time: 34.58s, train loss: 51.9129]
Tue 07 May 2024 17:55:46 INFO  epoch 25 evaluating [time: 19.56s, valid_score: 0.228600]
Tue 07 May 2024 17:55:46 INFO  valid result: 
recall@10 : 0.1095    mrr@10 : 0.2286    ndcg@10 : 0.1205    hit@10 : 0.5302    precision@10 : 0.0912
Tue 07 May 2024 17:56:20 INFO  epoch 26 training [time: 34.41s, train loss: 51.7877]
Tue 07 May 2024 17:56:40 INFO  epoch 26 evaluating [time: 19.96s, valid_score: 0.228700]
Tue 07 May 2024 17:56:40 INFO  valid result: 
recall@10 : 0.1099    mrr@10 : 0.2287    ndcg@10 : 0.1209    hit@10 : 0.5313    precision@10 : 0.0918
Tue 07 May 2024 17:57:19 INFO  epoch 27 training [time: 38.65s, train loss: 51.7274]
Tue 07 May 2024 17:57:41 INFO  epoch 27 evaluating [time: 21.62s, valid_score: 0.228300]
Tue 07 May 2024 17:57:41 INFO  valid result: 
recall@10 : 0.1092    mrr@10 : 0.2283    ndcg@10 : 0.1205    hit@10 : 0.5302    precision@10 : 0.091
Tue 07 May 2024 17:58:19 INFO  epoch 28 training [time: 38.79s, train loss: 51.6105]
Tue 07 May 2024 17:58:41 INFO  epoch 28 evaluating [time: 21.09s, valid_score: 0.228700]
Tue 07 May 2024 17:58:41 INFO  valid result: 
recall@10 : 0.1091    mrr@10 : 0.2287    ndcg@10 : 0.1206    hit@10 : 0.5302    precision@10 : 0.0911
Tue 07 May 2024 17:59:16 INFO  epoch 29 training [time: 35.61s, train loss: 51.5139]
Tue 07 May 2024 17:59:36 INFO  epoch 29 evaluating [time: 20.04s, valid_score: 0.228700]
Tue 07 May 2024 17:59:36 INFO  valid result: 
recall@10 : 0.1092    mrr@10 : 0.2287    ndcg@10 : 0.1206    hit@10 : 0.5313    precision@10 : 0.0911
Tue 07 May 2024 18:00:12 INFO  epoch 30 training [time: 35.53s, train loss: 51.4333]
Tue 07 May 2024 18:00:32 INFO  epoch 30 evaluating [time: 19.91s, valid_score: 0.228600]
Tue 07 May 2024 18:00:32 INFO  valid result: 
recall@10 : 0.1095    mrr@10 : 0.2286    ndcg@10 : 0.1207    hit@10 : 0.5313    precision@10 : 0.0912
Tue 07 May 2024 18:00:32 INFO  Finished training, best eval result in epoch 19
Tue 07 May 2024 18:00:32 INFO  Loading model structure and parameters from saved/FISM-May-07-2024_17-27-52.pth
Tue 07 May 2024 18:00:53 INFO  The running environment of this training is as follows:
+-------------+----------------+
| Environment |     Usage      |
+=============+================+
| CPU         |     2.20 %     |
+-------------+----------------+
| GPU         |   0.0 / 0.0    |
+-------------+----------------+
| Memory      | 0.66 G/13.86 G |
+-------------+----------------+
Tue 07 May 2024 18:00:53 INFO  best valid : OrderedDict([('recall@10', 0.1105), ('mrr@10', 0.2305), ('ndcg@10', 0.1208), ('hit@10', 0.5355), ('precision@10', 0.0912)])
Tue 07 May 2024 18:00:53 INFO  test result: OrderedDict([('recall@10', 0.122), ('mrr@10', 0.2669), ('ndcg@10', 0.1409), ('hit@10', 0.562), ('precision@10', 0.1055)])
Tue 07 May 2024 18:27:11 INFO  ['/home/stef/.local/lib/python3.10/site-packages/ipykernel_launcher.py', '-f', '/home/stef/.local/share/jupyter/runtime/kernel-efa788d2-160d-4c4b-a772-cea6c099cb9e.json']
Tue 07 May 2024 18:27:11 INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = dataset/ml100k_explicit_nais
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 100
train_batch_size = 2048
learner = adam
learning_rate = 0.01
train_neg_sample_args = {'distribution': 'uniform', 'sample_num': 1, 'alpha': 1.0, 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'RO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = False
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 4096
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = rating
TIME_FIELD = timestamp
seq_len = None
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = None
algorithm = prod
embedding_size = 64
weight_size = 64
split_to = 0
reg_weights = [1e-07, 1e-07, 1e-05]
alpha = 0.0
beta = 0.5
pretrain_path = None
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.GENERAL
eval_setting = RO_RS
early_stop = 5
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
device = cpu
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


Tue 07 May 2024 18:27:12 INFO  ml100k_explicit_nais
The number of users: 944
Average actions of users: 106.04453870625663
The number of items: 1683
Average actions of items: 59.45303210463734
The number of inters: 100000
The sparsity of the dataset: 93.70575143257098%
Remain Fields: ['user_id', 'item_id']
Tue 07 May 2024 18:27:12 INFO  [Training]: train_batch_size = [2048] train_neg_sample_args: [{'distribution': 'uniform', 'sample_num': 1, 'alpha': 1.0, 'dynamic': False, 'candidate_num': 0}]
Tue 07 May 2024 18:27:12 INFO  [Evaluation]: eval_batch_size = [4096] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'RO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
Tue 07 May 2024 18:27:12 WARNING  Max value of user's history interaction records has reached 35.115864527629235% of the total.
Tue 07 May 2024 18:27:12 WARNING  Pay Attetion!! the `split_to` is set to 0. If you catch a OMM error in this case, you need to increase it 
			until the error disappears. For example, you can append it in the command line such as `--split_to=5`
Tue 07 May 2024 18:27:12 INFO  unused pretrain...
Tue 07 May 2024 18:27:12 INFO  NAIS(
  (item_src_embedding): Embedding(1683, 64, padding_idx=0)
  (item_dst_embedding): Embedding(1683, 64, padding_idx=0)
  (mlp_layers): MLPLayers(
    (mlp_layers): Sequential(
      (0): Dropout(p=0.0, inplace=False)
      (1): Linear(in_features=64, out_features=64, bias=True)
      (2): ReLU()
    )
  )
  (bceloss): BCEWithLogitsLoss()
)
Trainable parameters: 221331
Tue 07 May 2024 18:27:12 INFO  FLOPs: 2458624.0
Tue 07 May 2024 18:30:45 INFO  epoch 0 training [time: 213.02s, train loss: 37.3203]
Tue 07 May 2024 18:32:12 INFO  epoch 0 evaluating [time: 86.89s, valid_score: 0.309800]
Tue 07 May 2024 18:32:12 INFO  valid result: 
recall@10 : 0.1648    mrr@10 : 0.3098    ndcg@10 : 0.1753    hit@10 : 0.6702    precision@10 : 0.1243
Tue 07 May 2024 18:32:12 INFO  Saving current: saved/NAIS-May-07-2024_18-27-12.pth
Tue 07 May 2024 18:35:43 INFO  epoch 1 training [time: 211.00s, train loss: 30.5565]
Tue 07 May 2024 18:37:12 INFO  epoch 1 evaluating [time: 89.22s, valid_score: 0.326900]
Tue 07 May 2024 18:37:12 INFO  valid result: 
recall@10 : 0.1855    mrr@10 : 0.3269    ndcg@10 : 0.192    hit@10 : 0.701    precision@10 : 0.1359
Tue 07 May 2024 18:37:12 INFO  Saving current: saved/NAIS-May-07-2024_18-27-12.pth
Tue 07 May 2024 18:40:48 INFO  epoch 2 training [time: 215.45s, train loss: 25.9834]
Tue 07 May 2024 18:42:16 INFO  epoch 2 evaluating [time: 88.71s, valid_score: 0.220500]
Tue 07 May 2024 18:42:16 INFO  valid result: 
recall@10 : 0.1397    mrr@10 : 0.2205    ndcg@10 : 0.1334    hit@10 : 0.6013    precision@10 : 0.104
Tue 07 May 2024 18:45:50 INFO  epoch 3 training [time: 213.57s, train loss: 13.0883]
Tue 07 May 2024 18:47:25 INFO  epoch 3 evaluating [time: 95.35s, valid_score: 0.246700]
Tue 07 May 2024 18:47:25 INFO  valid result: 
recall@10 : 0.126    mrr@10 : 0.2467    ndcg@10 : 0.1355    hit@10 : 0.5949    precision@10 : 0.1004
Tue 07 May 2024 18:50:49 INFO  epoch 4 training [time: 203.20s, train loss: 7.0089]
Tue 07 May 2024 18:52:23 INFO  epoch 4 evaluating [time: 94.42s, valid_score: 0.207500]
Tue 07 May 2024 18:52:23 INFO  valid result: 
recall@10 : 0.1035    mrr@10 : 0.2075    ndcg@10 : 0.1136    hit@10 : 0.5133    precision@10 : 0.0864
Tue 07 May 2024 18:56:07 INFO  epoch 5 training [time: 223.64s, train loss: 5.7466]
Tue 07 May 2024 18:57:41 INFO  epoch 5 evaluating [time: 94.69s, valid_score: 0.220100]
Tue 07 May 2024 18:57:41 INFO  valid result: 
recall@10 : 0.1053    mrr@10 : 0.2201    ndcg@10 : 0.1187    hit@10 : 0.5249    precision@10 : 0.0885
Tue 07 May 2024 19:01:13 INFO  epoch 6 training [time: 211.71s, train loss: 4.4689]
Tue 07 May 2024 19:02:39 INFO  epoch 6 evaluating [time: 85.64s, valid_score: 0.219600]
Tue 07 May 2024 19:02:39 INFO  valid result: 
recall@10 : 0.092    mrr@10 : 0.2196    ndcg@10 : 0.1102    hit@10 : 0.4814    precision@10 : 0.0804
Tue 07 May 2024 19:06:02 INFO  epoch 7 training [time: 203.58s, train loss: 2.7242]
Tue 07 May 2024 19:07:28 INFO  epoch 7 evaluating [time: 85.38s, valid_score: 0.198600]
Tue 07 May 2024 19:07:28 INFO  valid result: 
recall@10 : 0.0785    mrr@10 : 0.1986    ndcg@10 : 0.097    hit@10 : 0.4305    precision@10 : 0.0702
Tue 07 May 2024 19:10:52 INFO  epoch 8 training [time: 204.08s, train loss: 1.9907]
Tue 07 May 2024 19:12:16 INFO  epoch 8 evaluating [time: 84.68s, valid_score: 0.172000]
Tue 07 May 2024 19:12:16 INFO  valid result: 
recall@10 : 0.0662    mrr@10 : 0.172    ndcg@10 : 0.0792    hit@10 : 0.3934    precision@10 : 0.0562
Tue 07 May 2024 19:15:41 INFO  epoch 9 training [time: 204.21s, train loss: 1.2183]
Tue 07 May 2024 19:17:05 INFO  epoch 9 evaluating [time: 84.77s, valid_score: 0.130300]
Tue 07 May 2024 19:17:05 INFO  valid result: 
recall@10 : 0.0531    mrr@10 : 0.1303    ndcg@10 : 0.0591    hit@10 : 0.3245    precision@10 : 0.0414
Tue 07 May 2024 19:20:29 INFO  epoch 10 training [time: 203.83s, train loss: 0.9219]
Tue 07 May 2024 19:21:54 INFO  epoch 10 evaluating [time: 84.81s, valid_score: 0.092400]
Tue 07 May 2024 19:21:54 INFO  valid result: 
recall@10 : 0.0443    mrr@10 : 0.0924    ndcg@10 : 0.0443    hit@10 : 0.2503    precision@10 : 0.029
Tue 07 May 2024 19:25:18 INFO  epoch 11 training [time: 203.90s, train loss: 0.9048]
Tue 07 May 2024 19:26:43 INFO  epoch 11 evaluating [time: 84.56s, valid_score: 0.094400]
Tue 07 May 2024 19:26:43 INFO  valid result: 
recall@10 : 0.0397    mrr@10 : 0.0944    ndcg@10 : 0.0408    hit@10 : 0.2386    precision@10 : 0.0268
Tue 07 May 2024 19:30:06 INFO  epoch 12 training [time: 203.91s, train loss: 0.5978]
Tue 07 May 2024 19:31:31 INFO  epoch 12 evaluating [time: 84.59s, valid_score: 0.085200]
Tue 07 May 2024 19:31:31 INFO  valid result: 
recall@10 : 0.0404    mrr@10 : 0.0852    ndcg@10 : 0.0392    hit@10 : 0.246    precision@10 : 0.0276
Tue 07 May 2024 19:31:31 INFO  Finished training, best eval result in epoch 1
Tue 07 May 2024 19:31:31 INFO  Loading model structure and parameters from saved/NAIS-May-07-2024_18-27-12.pth
Tue 07 May 2024 19:32:57 INFO  The running environment of this training is as follows:
+-------------+----------------+
| Environment |     Usage      |
+=============+================+
| CPU         |     1.30 %     |
+-------------+----------------+
| GPU         |   0.0 / 0.0    |
+-------------+----------------+
| Memory      | 0.85 G/13.86 G |
+-------------+----------------+
Tue 07 May 2024 19:32:57 INFO  best valid : OrderedDict([('recall@10', 0.1855), ('mrr@10', 0.3269), ('ndcg@10', 0.192), ('hit@10', 0.701), ('precision@10', 0.1359)])
Tue 07 May 2024 19:32:57 INFO  test result: OrderedDict([('recall@10', 0.2224), ('mrr@10', 0.4031), ('ndcg@10', 0.2473), ('hit@10', 0.7529), ('precision@10', 0.1724)])
Wed 08 May 2024 10:49:07 INFO  ['/home/stef/.local/lib/python3.10/site-packages/ipykernel_launcher.py', '-f', '/home/stef/.local/share/jupyter/runtime/kernel-efa788d2-160d-4c4b-a772-cea6c099cb9e.json']
Wed 08 May 2024 10:49:07 INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = dataset/ml100k_implicit_nais
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 100
train_batch_size = 2048
learner = adam
learning_rate = 0.01
train_neg_sample_args = {'distribution': 'uniform', 'sample_num': 1, 'alpha': 1.0, 'dynamic': False, 'candidate_num': 0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'RO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = False
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 4096
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = rating
TIME_FIELD = timestamp
seq_len = None
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = None
algorithm = prod
embedding_size = 64
weight_size = 64
split_to = 0
reg_weights = [1e-07, 1e-07, 1e-05]
alpha = 0.0
beta = 0.5
pretrain_path = None
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.GENERAL
eval_setting = RO_RS
early_stop = 5
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
device = cpu
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


Wed 08 May 2024 10:49:07 INFO  ml100k_implicit_nais
The number of users: 944
Average actions of users: 106.04453870625663
The number of items: 1683
Average actions of items: 59.45303210463734
The number of inters: 100000
The sparsity of the dataset: 93.70575143257098%
Remain Fields: ['user_id', 'item_id']
Wed 08 May 2024 10:49:07 INFO  [Training]: train_batch_size = [2048] train_neg_sample_args: [{'distribution': 'uniform', 'sample_num': 1, 'alpha': 1.0, 'dynamic': False, 'candidate_num': 0}]
Wed 08 May 2024 10:49:07 INFO  [Evaluation]: eval_batch_size = [4096] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'RO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
Wed 08 May 2024 10:49:07 WARNING  Max value of user's history interaction records has reached 35.115864527629235% of the total.
Wed 08 May 2024 10:49:07 WARNING  Pay Attetion!! the `split_to` is set to 0. If you catch a OMM error in this case, you need to increase it 
			until the error disappears. For example, you can append it in the command line such as `--split_to=5`
Wed 08 May 2024 10:49:07 INFO  unused pretrain...
Wed 08 May 2024 10:49:07 INFO  NAIS(
  (item_src_embedding): Embedding(1683, 64, padding_idx=0)
  (item_dst_embedding): Embedding(1683, 64, padding_idx=0)
  (mlp_layers): MLPLayers(
    (mlp_layers): Sequential(
      (0): Dropout(p=0.0, inplace=False)
      (1): Linear(in_features=64, out_features=64, bias=True)
      (2): ReLU()
    )
  )
  (bceloss): BCEWithLogitsLoss()
)
Trainable parameters: 221331
Wed 08 May 2024 10:49:07 INFO  FLOPs: 2458624.0
Wed 08 May 2024 10:52:38 INFO  epoch 0 training [time: 210.62s, train loss: 37.3203]
Wed 08 May 2024 10:54:03 INFO  epoch 0 evaluating [time: 84.68s, valid_score: 0.309800]
Wed 08 May 2024 10:54:03 INFO  valid result: 
recall@10 : 0.1648    mrr@10 : 0.3098    ndcg@10 : 0.1753    hit@10 : 0.6702    precision@10 : 0.1243
Wed 08 May 2024 10:54:03 INFO  Saving current: saved/NAIS-May-08-2024_10-49-07.pth
Wed 08 May 2024 10:57:30 INFO  epoch 1 training [time: 207.43s, train loss: 30.5565]
Wed 08 May 2024 10:59:02 INFO  epoch 1 evaluating [time: 92.28s, valid_score: 0.326900]
Wed 08 May 2024 10:59:02 INFO  valid result: 
recall@10 : 0.1855    mrr@10 : 0.3269    ndcg@10 : 0.192    hit@10 : 0.701    precision@10 : 0.1359
Wed 08 May 2024 10:59:02 INFO  Saving current: saved/NAIS-May-08-2024_10-49-07.pth
Wed 08 May 2024 11:02:32 INFO  epoch 2 training [time: 209.61s, train loss: 25.9834]
Wed 08 May 2024 11:03:58 INFO  epoch 2 evaluating [time: 85.77s, valid_score: 0.220500]
Wed 08 May 2024 11:03:58 INFO  valid result: 
recall@10 : 0.1397    mrr@10 : 0.2205    ndcg@10 : 0.1334    hit@10 : 0.6013    precision@10 : 0.104
Wed 08 May 2024 11:07:28 INFO  epoch 3 training [time: 210.10s, train loss: 13.0883]
Wed 08 May 2024 11:08:54 INFO  epoch 3 evaluating [time: 85.61s, valid_score: 0.246700]
Wed 08 May 2024 11:08:54 INFO  valid result: 
recall@10 : 0.126    mrr@10 : 0.2467    ndcg@10 : 0.1355    hit@10 : 0.5949    precision@10 : 0.1004
Wed 08 May 2024 11:12:23 INFO  epoch 4 training [time: 209.50s, train loss: 7.0089]
Wed 08 May 2024 11:13:47 INFO  epoch 4 evaluating [time: 84.37s, valid_score: 0.207500]
Wed 08 May 2024 11:13:47 INFO  valid result: 
recall@10 : 0.1035    mrr@10 : 0.2075    ndcg@10 : 0.1136    hit@10 : 0.5133    precision@10 : 0.0864
Wed 08 May 2024 11:17:43 INFO  epoch 5 training [time: 235.46s, train loss: 5.7466]
Wed 08 May 2024 11:19:20 INFO  epoch 5 evaluating [time: 97.02s, valid_score: 0.220100]
Wed 08 May 2024 11:19:20 INFO  valid result: 
recall@10 : 0.1053    mrr@10 : 0.2201    ndcg@10 : 0.1187    hit@10 : 0.5249    precision@10 : 0.0885
Wed 08 May 2024 11:23:04 INFO  epoch 6 training [time: 224.49s, train loss: 4.4689]
Wed 08 May 2024 11:24:29 INFO  epoch 6 evaluating [time: 84.65s, valid_score: 0.219600]
Wed 08 May 2024 11:24:29 INFO  valid result: 
recall@10 : 0.092    mrr@10 : 0.2196    ndcg@10 : 0.1102    hit@10 : 0.4814    precision@10 : 0.0804
Wed 08 May 2024 11:28:09 INFO  epoch 7 training [time: 219.61s, train loss: 2.7242]
Wed 08 May 2024 11:29:57 INFO  epoch 7 evaluating [time: 108.70s, valid_score: 0.198600]
Wed 08 May 2024 11:29:57 INFO  valid result: 
recall@10 : 0.0785    mrr@10 : 0.1986    ndcg@10 : 0.097    hit@10 : 0.4305    precision@10 : 0.0702
Wed 08 May 2024 11:33:33 INFO  epoch 8 training [time: 215.59s, train loss: 1.9907]
Wed 08 May 2024 11:34:58 INFO  epoch 8 evaluating [time: 84.84s, valid_score: 0.172000]
Wed 08 May 2024 11:34:58 INFO  valid result: 
recall@10 : 0.0662    mrr@10 : 0.172    ndcg@10 : 0.0792    hit@10 : 0.3934    precision@10 : 0.0562
Wed 08 May 2024 11:38:28 INFO  epoch 9 training [time: 209.92s, train loss: 1.2183]
Wed 08 May 2024 11:39:53 INFO  epoch 9 evaluating [time: 84.97s, valid_score: 0.130300]
Wed 08 May 2024 11:39:53 INFO  valid result: 
recall@10 : 0.0531    mrr@10 : 0.1303    ndcg@10 : 0.0591    hit@10 : 0.3245    precision@10 : 0.0414
Wed 08 May 2024 11:43:23 INFO  epoch 10 training [time: 210.28s, train loss: 0.9219]
Wed 08 May 2024 11:44:47 INFO  epoch 10 evaluating [time: 84.51s, valid_score: 0.092400]
Wed 08 May 2024 11:44:47 INFO  valid result: 
recall@10 : 0.0443    mrr@10 : 0.0924    ndcg@10 : 0.0443    hit@10 : 0.2503    precision@10 : 0.029
Wed 08 May 2024 11:48:08 INFO  epoch 11 training [time: 200.34s, train loss: 0.9048]
Wed 08 May 2024 11:49:30 INFO  epoch 11 evaluating [time: 81.75s, valid_score: 0.094400]
Wed 08 May 2024 11:49:30 INFO  valid result: 
recall@10 : 0.0397    mrr@10 : 0.0944    ndcg@10 : 0.0408    hit@10 : 0.2386    precision@10 : 0.0268
Wed 08 May 2024 11:52:50 INFO  epoch 12 training [time: 200.23s, train loss: 0.5978]
Wed 08 May 2024 11:54:12 INFO  epoch 12 evaluating [time: 82.22s, valid_score: 0.085200]
Wed 08 May 2024 11:54:12 INFO  valid result: 
recall@10 : 0.0404    mrr@10 : 0.0852    ndcg@10 : 0.0392    hit@10 : 0.246    precision@10 : 0.0276
Wed 08 May 2024 11:54:12 INFO  Finished training, best eval result in epoch 1
Wed 08 May 2024 11:54:12 INFO  Loading model structure and parameters from saved/NAIS-May-08-2024_10-49-07.pth
Wed 08 May 2024 11:55:35 INFO  The running environment of this training is as follows:
+-------------+----------------+
| Environment |     Usage      |
+=============+================+
| CPU         |     1.30 %     |
+-------------+----------------+
| GPU         |   0.0 / 0.0    |
+-------------+----------------+
| Memory      | 0.85 G/13.86 G |
+-------------+----------------+
Wed 08 May 2024 11:55:35 INFO  best valid : OrderedDict([('recall@10', 0.1855), ('mrr@10', 0.3269), ('ndcg@10', 0.192), ('hit@10', 0.701), ('precision@10', 0.1359)])
Wed 08 May 2024 11:55:35 INFO  test result: OrderedDict([('recall@10', 0.2224), ('mrr@10', 0.4031), ('ndcg@10', 0.2473), ('hit@10', 0.7529), ('precision@10', 0.1724)])
